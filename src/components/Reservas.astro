<section class="max-w-5xl w-full bg-white py-12 p-8 mx-auto mt-5 rounded-lg shadow-md">
    <h2 class="text-2xl font-bold text-gray-900 mb-2 text-center md:text-left">
        Haz tu reserva rápida y segura.
    </h2>
    <p class="text-gray-600 mb-6 text-center md:text-left">
        Selecciona una experiencia, indica las fechas, completa tus datos y nuestro equipo se pondrá en contacto contigo. ¡Reserva ahora y cambia tu vida!
    </p>

    <form class="grid grid-cols-1 md:grid-cols-2 gap-4" id="formReserva">
        <div>
            <label for="nombres" class="block text-gray-700 font-semibold mb-1">
                Nombres y Apellidos
            </label>
            <input type="text" id="nombres" name="nombres" placeholder="Ingresa tus datos..." class="w-full px-4 py-2 border border-green-900 focus:border-green-600 focus:outline focus:outline-green-700 rounded-md bg-gray-50"/>
        </div>

        <div>
            <label for="experienciaSelect" class="block text-gray-700 font-semibold mb-1">
                Experiencias
            </label>
            <select id="experienciaSelect" name="experienciaSelect" class="w-full px-4 py-2 border border-green-900 focus:border-green-600 focus:outline focus:outline-green-700 rounded-md bg-gray-50">
                <option value="">Selecciona una experiencia</option>
            </select>
        </div>

        <div>
            <label for="fechaIngreso" class="block text-gray-700 font-semibold mb-1">
                Fecha de Inicio
            </label>
            <input type="date" id="fechaIngreso" name="fechaIngreso" class="w-full px-4 py-2 border border-green-900 focus:border-green-600 focus:outline focus:outline-green-700 rounded-md bg-gray-50"/>
        </div>

        <div>
            <label for="fechaSalida" class="block text-gray-700 font-semibold mb-1">
                Fecha de Fin
            </label>
            <input type="date" id="fechaSalida" name="fechaSalida" class="w-full px-4 py-2 border border-green-900 focus:border-green-600 focus:outline focus:outline-green-700 rounded-md bg-gray-50"/>
        </div>

        <div class="md:col-span-2">
            <button type="submit" id="consultarBtn" class="w-full bg-green-800 hover:bg-green-900 text-white py-3 rounded-md font-semibold flex items-center justify-center cursor-pointer transition duration-300" aria-label="Consultar experiencia">
                Consultar Ahora
                <i class="fa-brands fa-whatsapp ml-2"></i>
            </button>
        </div>
    </form>
</section>

<script is:inline>
    document.addEventListener("DOMContentLoaded", function () {
        const experiencias = [
            { id: "1", nombre: "Retiros" },
            { id: "2", nombre: "Campamentos Conscientes" },
            { id: "3", nombre: "Entrenamientos Corporativos" },
        ];

        const experienciaSelect = document.getElementById("experienciaSelect");
        const nombreInput = document.getElementById("nombres");
        const fechaIngreso = document.getElementById("fechaIngreso");
        const fechaSalida = document.getElementById("fechaSalida");
        const consultarBtn = document.getElementById("consultarBtn");

        if (!experienciaSelect || !nombreInput || !fechaIngreso || !fechaSalida || !consultarBtn) {
            return;
        }

        experiencias.forEach(exp => {
            const option = document.createElement("option");
            option.value = exp.id;
            option.textContent = exp.nombre;
            experienciaSelect.appendChild(option);
        });

        function formatoFecha(fechaStr) {
            if (!fechaStr) return "";
            const meses = [
                "enero", "febrero", "marzo", "abril", "mayo", "junio",
                "julio", "agosto", "septiembre", "octubre", "noviembre", "diciembre"
            ];
            const fecha = new Date(fechaStr);
            if (isNaN(fecha.getTime())) return "";
            return `${fecha.getDate()} de ${meses[fecha.getMonth()]} de ${fecha.getFullYear()}`;
        }

        consultarBtn.addEventListener("click", function (event) {
            event.preventDefault();

            const nombre = nombreInput.value.trim();
            const experiencia = experienciaSelect.options[experienciaSelect.selectedIndex]?.text || "";
            const ingreso = formatoFecha(fechaIngreso.value);
            const salida = formatoFecha(fechaSalida.value);

            if (!nombre || !experienciaSelect.value || !ingreso || !salida) {
                return;
            }

            const mensaje = `Hola, *Ecolodge Cabañas y Retiros*. Me llamo ${nombre} y estoy interesado en la *Experiencia:* ${experiencia}, del ${ingreso} al ${salida}.`;

            const numeroWhatsApp = "51984746645";
            const url = `https://wa.me/${numeroWhatsApp}?text=${encodeURIComponent(mensaje)}`;

            window.open(url, "_blank");
        });
    });
</script>